#!/usr/bin/env ruby
lib_dir = File.dirname(__FILE__)
require File.expand_path(File.join(lib_dir, '../lib/roy'))

create_options = {:create_options => {
  :visibility_timeout => 90,
  :maximum_message_size => 262144
}}

poll_options = {:poll_options => {
  :wait_time_seconds => 10,
  :idle_timeout => 5
}}

config = {
  :watchers => [{
    :perform => :watcher_life_cycle_hook,
    :queue => {
      :name => "watcher_life_cycle_hook",
    }.merge(create_options).merge(poll_options)
  },
  {
    :perform => :god_unmonitor,
    :queue => {
      :name => "god_unmonitor",
    }.merge(create_options).merge(poll_options)
  }]
}

roy = Roy.new(config)
roy.watchers.last.publish(:task_or_group_name => :anthony)

